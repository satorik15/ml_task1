# Отчет по домашнему заданию №1:EDA и обучение модели машинного обучения для предсказания цены автомобиля

## В ходе выполнения ДЗ1 были пройдены следующие этапы:

### 1. Exploratory Data Analysis (EDA) и предобработка данных
- **Анализ структуры данных:** изучение типов признаков, проверка на пропуски и дубликаты
- **Обработка пропусков:** заполнение медианами для числовых признаков (с использованием медиан только из тренировочного набора)
- **Удаление дубликатов:** обработка полных и частичных дубликатов (объектов с одинаковым признаковым описанием)
- **Преобразование признаков:**
  - Очистка числовых признаков (`mileage`, `engine`, `max_power`) от единиц измерения
  - Удаление столбца `torque` как слишком сложного для обработки
  - Удаление столбца `name` из-за большого количества уникальных значений
  - Преобразование типов данных к корректным форматам

### 2. Визуализация и анализ данных
- **Pairplot анализ:** изучение распределений признаков и их взаимосвязей
- **Корреляционный анализ:** построение тепловой карты корреляций Пирсона
- **Статистический анализ:** вычисление основных статистик для числовых и категориальных признаков
- **Бонусные визуализации:** диаграмма распределения целевой переменной

### 3. Построение и сравнение моделей
### На данном этапе были обучены следующие модели:
#### Модели только на вещественных признаках:
- **Линейная регрессия (базовая)**
- **Линейная регрессия со стандартизацией**
- **Lasso регрессия** с регуляризацией
- **ElasticNet регрессия** с подбором гиперпараметров - данная модель в моем случае дала лучший результат и была использована в приложении

#### Модели с категориальными признаками:
- **Ridge регрессия** с OneHot-кодированием категориальных признаков

### 4. Создание Streamlit приложения
- **Раздел EDA:** интерактивные графики и визуализации
- **Раздел загрузки датасета:** CSV файл
- **Визуализация модели:** графики зависимости признаков, pie-chart диаграмма годов автомобилей, распределение целевой переменной
- **Автоматическая предобработка:** реализованы те же преобразования, что и в ноутбуке

## Результаты и метрики
### R2
- Linear Regression (числовые): 0.594
- Lasso (числовые): 0.572
- ElasticNet (числовые): 0.576
- Ridge (с категориальными): 0.345

Вывод: Даже лучшая модель имеет R² около 0.59, что означает, что модель объясняет только 59% дисперсии цены. Это уже неплохо для старта, но недостаточно для полноценного использования в проде. Поэтому потребуется дополнительная доработка модели.

### Лучшие результаты моделей по бизнес метрике:
Доля прогнозов с ошибкой меньше 10% по модулю):
- Linear Regression (числовые): 22.7000
- Lasso (числовые): 23.5000
- ElasticNet (числовые): 24.1000
- Ridge (с категориальными): 15.7000

По результатам можно сделать вывод, что даже лучшая модель покрываем только 24%, что означает необходимость дальнейшего улучшения модели


## Что дало наибольший прирост качества

### 1. Качественная предобработка данных
- **Очистка числовых признаков** от единиц измерения дала возможность использовать их в моделях
- **Заполнение пропусков медианами** предотвратило потерю данных
- **Удаление дубликатов** улучшило качество обучения

### 2. Правильная стратегия работы с данными
- **Стандартизация признаков** перед применением регуляризованных моделей
- **Отдельная обработка train и test**

### 3. Подбор гиперпараметров
- **GridSearchCV с кросс-валидацией** позволил найти оптимальные параметры для ElasticNet
- **Использование регуляризации** помогло улучшить обобщающую способность модели

## Что сделать не удалось и почему

- Не получилось придумать корректный способ кодировки категориальных признаков со множеством значений, так как методом OHE это бы сильно "раздуло" модель.
- Не удалось достичь высоких показателей по R2 и бизнес-метрике, скорее всего требуется добавление feature engeneering или использование более сложной модели
## Оценка разработанного сервиса:

- Приложение достаточно удобно в использовании, так как имеет одностраничную компановку и подсказку по загрузке csv файла, графики интерактивные, что добавляет гибкости.
- Хорошо получились графики, поддерживаемые streamlit, но не получилось настроить размеры pairplot из-за чего заменил его на pie-chart годов выпуска автомобиля.
- При деплое приложения на streamlit cloud возникли некоторые проблемы с зависимостями, но их удалось разрешить.
- В дальнешем планирую научиться делать многостраничные приложения и более гибко настраивать графики и компоненты приложения для повышения ui/ux
